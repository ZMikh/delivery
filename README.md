### Бизнес-процесс. Сервис доставки
Для запуска проекта выполнить команды в директории проекта
```
mvn package 
docker compose up
```

**Конфигурация**

- Переменные окружения для настройки проекта:
    - ```DATABASE_URL``` - url для подключения к БД
    - ```DATABASE_USERNAME``` - username БД
    - ```DATABASE_PASSWORD``` - password для входа в БД
    - ```KAFKA_GROUP_ID``` - идентификатор группы для подключения consumers

- Приложение запускается под портом ```8080```


- Использование Swagger для тестирования endpoints
```
http://localhost:8080/swagger-ui.html#/
```
**Особенности работы с endpoints**
 
Согласно Camunda BPM в проекте определены следующие Event ID:
- ```newState```
  - стартовоое событие
  
- ```inProcessingState```
  - заказ принят в обработку
  - устанавливается после отправки POST запроса по endpoint "Создание доставки"
  - при отправке GET запроса по id значение поля "state" соответствует **IN_PROCESSING**
  
- ```registeredState```
  - заказ оформлен
  - устанавливается после создания доставки и отправки POST запроса по endpoint "Подтверждение заказа"
    - в параметре "confirmationState" указывается значение на выбор
      - ```CONFIRMED```  - продолжить работу с заказом
      - ```CANCELLED``` - отменить заказ
  
- ```paymentErrorState```
  - неудачная попытка оплаты
  - устанавливается после подтверждения заказа и наличия в поле "description" значения, содержащего "error"
  - при отправке GET запроса по id значение поля "state" соответствует **PAYMENT_ERROR**
  
- ```paidState```
  - заказ оплачен
  - устанавливается после подтверждения и оплаты заказа
    - в параметре "confirmationState" указывается значение ```CONFIRMED```
  - при отправке GET запроса по id значение поля "state" соответствует **PAID**
  
- ```finishedState```
  - заказ выполнен
  - устанавливается после оплаты и получения информации о завершении доставки
    - доставка может завершаться двумя способами 
      - отправкой информации о завершении доставки курьером "delivery_finish_message"
      - самовывозом заказа 
        - при подтверждении заказа в поле "isPickUp" записывается true и отправляется POST запрос по endpoint "Выдача заказа клиенту самовывозом"
  - при отправке GET запроса по id значение поля "state" соответствует **FINISHED**
  
- ```clientCancellationState```
  - клиент отменил заказ
  - устанавливается на этапе подтверждения в случае отмены заказа клиентом
    - в параметре "confirmationState" указывается значение ```CANCELLED```
  - при отправке GET запроса по id значение поля "state" соответствует **CLIENT_CANCELLATION**
  
- ```techErrorState```
  - заказ отменен по тех причинам 
  - устанавливается после получения "cancel_message"
  - при отправке GET запроса по id значение поля "state" соответствует **TECH_ERROR**


**Используемые в проекте технологии**
- ```Spring Data Jpa```
- ```Flyway```
- ```ModelMapper```
- ```Camunda BPM```
- ```Apache Kafka```
- ```Swagger```
- ```Docker```
